<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Schnitzeljagd ‚Äì Station 2</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#020617;
  color:#e5e7eb;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}
.card{
  background:#0f172a;
  padding:24px;
  border-radius:16px;
  width:360px;
  box-shadow:0 20px 40px rgba(0,0,0,.6);
}
h1{
  text-align:center;
  color:#60a5fa;
  margin-top:0;
}
.section{margin-bottom:18px;}
.section input{
  width:100%;
  box-sizing:border-box;
  padding:12px;
  border-radius:10px;
  border:1px solid #334155;
  background:#020617;
  color:#e5e7eb;
}
button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:12px;
  background:#2563eb;
  color:white;
  font-weight:bold;
  cursor:pointer;
}
.hilfe{margin-top:10px;background:#475569;}
.hidden{display:none;}
#timer{
  text-align:center;
  margin-bottom:16px;
  color:#a5f3fc;
  font-weight:bold;
}
.hilfeBox{
  margin-top:16px;
  padding:16px;
  border-radius:14px;
  background:rgba(250,204,21,0.08);
  border:1px solid rgba(250,204,21,0.35);
  text-align:center;
}
.hilfeBox img{
  max-width:140px;
  margin:12px auto;
  display:block;
}
.erfolgBox{text-align:center;}
.checkIcon{
  width:48px;height:48px;margin:0 auto 12px;
  background:#22c55e;color:white;
  font-size:28px;border-radius:10px;
  display:flex;align-items:center;justify-content:center;
}
.raetselBox{
  padding:16px;border-radius:14px;
  background:rgba(34,197,94,0.12);
  border:1px solid rgba(34,197,94,0.45);
  color:#bbf7d0;
}
.buchstabenBox{
  margin-top:20px;padding:16px;
  border-radius:14px;text-align:center;
  background:rgba(239,68,68,0.12);
  border:2px solid rgba(239,68,68,0.6);
}
.buchstabe{font-size:3.5rem;font-weight:bold;color:#fecaca;}
</style>
</head>

<body>

<div class="card">

<div id="header">
  <h1>üìç Station 2</h1>
  <div id="timer">‚è±Ô∏è Zeit: 0 s</div>
</div>

<div id="gpsStatus" style="margin-bottom:14px;color:#fde68a;">
üì° Standort wird gepr√ºft ‚Ä¶
</div>

<form
  action="https://docs.google.com/forms/d/e/1FAIpQLSdULt5n9Mv6MJtZy1W7Y0RjT1_VW56ZkYACE-uukUErIK7trA/formResponse"
  method="POST"
  target="hidden_iframe"
  onsubmit="return auswerten();">

  <!-- feste Werte -->
  <input type="hidden" name="entry.2065943787" value="1">
  <input type="hidden" name="entry.277494817" value="2">
  <input type="hidden" name="entry.1434791088" id="hauptpunkte" value="0">
  <input type="hidden" name="entry.68499526" id="bonuspunkte" value="0">
  <input type="hidden" name="entry.2070741248" id="zeit">

  <!-- FRAGEN -->
  <div id="fragenBlock" class="hidden">

    <div class="section">
      <strong>üß© Hauptfrage</strong><br><br>
      Wie viele Zapfpistolen gibt es insgesamt?<br><br>
      <input type="text" id="hauptantwort"
             name="entry.634051671"
             required placeholder="Antwort eingeben">
    </div>

    <div class="section">
      <strong>‚≠ê Bonusfrage</strong><br><br>
      Welches Gefahrensymbol erkennt ihr?<br><br>
      <input type="text" id="bonusantwort"
             name="entry.1320841054"
             placeholder="Antwort eingeben">
    </div>

    <div id="hilfeBox" class="hilfeBox hidden">
      <strong>Hilfe ‚Äì Gefahrensymbol</strong>
      <img src="https://daniel911211.github.io/Bilder/Leicht-Entflammbar.png">
      <div>
        A: Gesundheitssch√§dlich<br>
        B: Leicht entz√ºndlich<br>
        C: Umweltgef√§hrlich
      </div>
    </div>

    <button class="hilfe" type="button" onclick="hilfe()">üÜò Hilfe zur Bonusfrage</button>
    <button type="submit">Antworten absenden</button>
  </div>
</form>

<div id="erfolg" class="hidden erfolgBox">
  <div class="checkIcon">‚úî</div>
  <div class="raetselBox">
    Wo g√ºnstig der Einkauf gelingt,<br>
    und Blau-Gelb weithin sichtbar blinkt.
  </div>
  <div class="buchstabenBox">
    <div>üîê L√∂sungsbuchstabe</div>
    <div class="buchstabe">R</div>
  </div>
</div>

<iframe name="hidden_iframe" style="display:none;"></iframe>

</div>

<script>
let start = null;
let gpsOK = false;
let hilfeGenutzt = false;

// ZIEL
const ZIEL_LAT = 50.45487398923756;
const ZIEL_LON = 9.614003849396829;
const TOLERANZ = 65;

navigator.geolocation.getCurrentPosition(pos=>{
  const d = dist(pos.coords.latitude,pos.coords.longitude,ZIEL_LAT,ZIEL_LON);
  if(d<=TOLERANZ){
    gpsOK=true;
    document.getElementById("gpsStatus").innerText="‚úÖ Standort best√§tigt";
    document.getElementById("fragenBlock").classList.remove("hidden");
    start=Date.now();
    setInterval(()=>document.getElementById("timer").innerText=
      "‚è±Ô∏è Zeit: "+Math.floor((Date.now()-start)/1000)+" s",1000);
  }else{
    document.getElementById("gpsStatus").innerText=`üìç Noch ${Math.round(d)} m entfernt`;
  }
},()=>document.getElementById("gpsStatus").innerText="üì° Standortfreigabe n√∂tig");

function dist(a,b,c,d){
  const R=6371000;
  const x=(c-a)*Math.PI/180;
  const y=(d-b)*Math.PI/180;
  const h=Math.sin(x/2)**2+
    Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin(y/2)**2;
  return R*2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h));
}

function hilfe(){
  hilfeGenutzt=true;
  document.getElementById("hilfeBox").classList.remove("hidden");
}

function auswerten(){
  if(!gpsOK) return false;
  document.getElementById("zeit").value=Math.floor((Date.now()-start)/1000);

  document.getElementById("hauptpunkte").value =
    document.getElementById("hauptantwort").value.trim()==="16"?10:0;

  const b=document.getElementById("bonusantwort").value.toLowerCase();
  document.getElementById("bonuspunkte").value =
    (!hilfeGenutzt && b.includes("leicht"))?10:(hilfeGenutzt && b==="b"?6:0);

  document.querySelector("form").classList.add("hidden");
  document.getElementById("header").classList.add("hidden");
  document.getElementById("erfolg").classList.remove("hidden");
  return true;
}
</script>

</body>
</html>
